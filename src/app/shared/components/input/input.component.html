<div class="form-group">
  <label *ngIf="label" [for]="id" class="form-label">
    {{ label }}
    <span *ngIf="required" class="text-danger">*</span>
  </label>
  <ng-content></ng-content>

  <ng-container *ngIf="isRegularInput">
    <div class="input-group">
      <input
        [type]="type === 'password' && showPassword ? 'text' : type"
        [id]="id"
        class="form-control {{ class }}"
        [placeholder]="placeholder"
        [(ngModel)]="internalValue"
        [disabled]="isDisabled || disabled"
        [readonly]="readonly"
        [required]="required"
        [mask]="mask"
        [ngStyle]="inputStyle"
        (focus)="onFocus()"
        (blur)="onBlur()"
        (input)="updateValue($event)"
      />
      <span *ngIf="type === 'password'" class="password-toggle" (click)="togglePasswordVisibility()">
        <i class="bi" [ngClass]="showPassword ? 'bi-eye-slash' : 'bi-eye'"></i>
      </span>
    </div>
  </ng-container>

  <ng-container *ngIf="isSelectInput">
    <mat-form-field appearance="outline" style="width: 100%;" color="primary">
      <mat-select
        [id]="id"
        [value]="internalValue"
        [disabled]="isDisabled || disabled"
        [required]="required"
        [ngStyle]="inputStyle"
        [multiple]="inputType === 'multiselect'"
        (selectionChange)="updateValue($event)"
      >
        <mat-select-trigger *ngIf="inputType === 'multiselect'">
          <ng-container *ngFor="let selected of selectedOptions">
            <span class="custom-chip">
              {{ getOptionLabel(selected) }}
              <span
                class="custom-chip-remove"
                (click)="$event.stopPropagation(); removeSelectedOption(selected);"
              >
                &times;
              </span>
            </span>
          </ng-container>
        </mat-select-trigger>
        <mat-option *ngIf="placeholder" value="" disabled>{{ placeholder }}</mat-option>
        <mat-option *ngFor="let option of options" [value]="option[optionValue]">
          {{ option[optionLabel] }}
        </mat-option>
      </mat-select>
    </mat-form-field>
  </ng-container>

  <ng-container *ngIf="isTextarea">
    <textarea
      [id]="id"
      class="form-control {{ class }}"
      [placeholder]="placeholder"
      [(ngModel)]="internalValue"
      [disabled]="isDisabled || disabled"
      [readonly]="readonly"
      [required]="required"
      [rows]="rows"
      [ngStyle]="inputStyle"
      (focus)="onFocus()"
      (blur)="onBlur()"
      (input)="updateValue($event)"
    ></textarea>
  </ng-container>

  <ng-container *ngIf="isCheckbox">
    <div class="form-check">
      <input
        type="checkbox"
        [id]="id"
        class="form-check-input {{ class }}"
        [(ngModel)]="internalValue"
        [disabled]="isDisabled || disabled"
        [required]="required"
        (change)="updateValue($event)"
        style="cursor: pointer;"
      />
      <label class="form-check-label small text-secondary-60" [for]="id">
        {{ checkboxLabel }}
      </label>
    </div>
  </ng-container>

  <div *ngIf="errorMessage && (!showErrorOnTouched || isTouched)" class="text-danger small mt-1">
    {{ errorMessage }}
  </div>
</div>
